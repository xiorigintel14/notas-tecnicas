<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Notas</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#121212">
    <style>
        /* ESTILOS GENERALES */
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #121212; color: #e0e0e0; padding: 15px; padding-bottom: 120px; margin: 0; }
        
        .top-header { color: #bb86fc; text-align: center; margin-bottom: 15px; font-weight: bold; border-bottom: 2px solid #333; padding-bottom: 10px; text-transform: uppercase; font-size: 18px; letter-spacing: 1px;}
        
        h3 { color: #03dac6; border-bottom: 1px solid #333; padding-bottom: 5px; margin-top: 25px; font-size: 14px; text-transform: uppercase; letter-spacing: 0.5px;}
        
        label { display: block; margin-top: 12px; font-size: 12px; color: #aaa; font-weight: bold; text-transform: uppercase; margin-bottom: 4px;}
        
        /* INPUTS OPTIMIZADOS PARA TACTIL */
        input, textarea { width: 100%; padding: 12px; background: #1e1e1e; border: 1px solid #333; color: white; border-radius: 8px; box-sizing: border-box; font-size: 16px; /* 16px evita zoom en iOS */ }
        input:focus, textarea:focus { border-color: #bb86fc; outline: none; background: #252525;}
        
        /* GRID RESPONSIVO */
        .row-fixed { display: flex; gap: 10px;}
        .col { flex: 1; }
        
        /* FILAS DIN√ÅMICAS */
        .dynamic-row { display: flex; gap: 8px; margin-bottom: 10px; align-items: center; }
        .dynamic-row input.name { flex: 2; font-weight: bold; color: #ffb74d; font-size: 15px;}
        .dynamic-row input.desc { flex: 3; font-size: 15px;}
        
        /* BOTONES T√ÅCTILES MEJORADOS */
        .btn-del { width: 44px; height: 44px; background: #cf6679; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px;}
        
        .btn-add { background: #2e7d32; color: white; width: 100%; padding: 12px; border: none; border-radius: 8px; margin-top: 5px; cursor: pointer; font-weight: bold; font-size: 14px; margin-bottom: 15px; text-transform: uppercase;}
        
        /* BARRA INFERIOR FIJA */
        .btn-container { position: fixed; bottom: 0; left: 0; right: 0; background: #1e1e1e; padding: 12px; display: flex; gap: 8px; border-top: 2px solid #333; z-index: 1000; box-shadow: 0 -5px 15px rgba(0,0,0,0.5);}
        button.action { flex: 1; padding: 14px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; color: #000; font-size: 13px; text-transform: uppercase;}
        
        .btn-1 { background: #b9f6ca; } 
        .btn-2 { background: #80d8ff; } 
        .btn-3 { background: #ffcc80; } 
        
        .total-display { background: #333; color: #03dac6; text-align: center; border: 1px solid #03dac6; font-weight: bold;}
        
        .gps-group { display: flex; gap: 5px; }
        .btn-gps { background: #03dac6; border: none; border-radius: 8px; width: 50px; font-size: 24px; cursor: pointer; display: flex; align-items: center; justify-content: center;}
        
        #save-status { text-align: right; font-size: 11px; color: #03dac6; margin-top: -10px; margin-bottom: 15px; font-style: italic; min-height: 15px;}

        /* --- REGLA DE ORO PARA M√ìVILES PEQUE√ëOS --- */
        @media (max-width: 360px) {
            .row-fixed { flex-direction: column; gap: 5px; }
            .dynamic-row { flex-wrap: wrap; }
            .dynamic-row input.name { flex: 1 1 100%; } /* El nombre ocupa todo el ancho */
            .dynamic-row input.desc { flex: 1 1 80%; }   /* La descripci√≥n ocupa casi todo */
            .btn-del { flex: 0 0 44px; }                 /* El bot√≥n de borrar mantiene su tama√±o */
        }
        select {
            width: 100%;
            padding: 12px;
            background: #1e1e1e;
            border: 1px solid #333;
            color: white;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 16px;
                }
        select:focus {
            border-color: #bb86fc;
            outline: none;
            background: #252525;
                }

    </style>
</head>
<body>

    <div class="top-header">NOTAS</div>
    <div id="save-status"></div>

<div class="row-fixed">
  <div class="col">
    <label>Tipo de nota</label>
    <select id="tipoNota">
      <option value="">Seleccione tipo de nota</option>
      <option value="INSTALACION">INSTALACION</option>
      <option value="VT">VT</option>
      <option value="CDD">CDD</option>
      <option value="MIGRACION">MIGRACION</option>
      <option value="APROADI">APROADI</option>
      <option value="INSTALACION HFC">INSTALACION HFC</option>
      <option value="VT HFC">VT HFC</option>
    </select>
  </div>

  <div class="col">
    <label>N¬∞ de tarea</label>
    <input type="text" id="numTarea" placeholder="Ej: 123456">
  </div>
</div>

    <div class="row-fixed">
        <div class="col"><label>CTO</label><input type="tel" id="cto" placeholder="Ej: 9937..."></div>
        <div class="col"><label>CTA</label><input type="tel" id="cta" placeholder="Ej: 1013..."></div>
    </div>

    <label>CLIENTE</label>
    <input type="text" id="cliente" placeholder="Nombre completo del cliente">
    

    <div class="row-fixed">
        <div class="col"><label>PERSONA QUE ATIENDE</label><input type="text" id="patiende" placeholder="Nombre completo del cliente"></div>
        <div class="col"><label>Celular</label><input type="tel" id="cel"></div>
    </div>

    <label>TEC</label>
    <input type="text" id="tec" value="ORINGITEL #">

    <div class="row-fixed">
        <div class="col"><label>NAP</label><input type="text" id="nap" placeholder="CJA-..."></div>
        <div class="col">
            <label>COORDENADAS NAP</label>
            <div class="gps-group">
                <input type="text" id="coords" placeholder="Pegar Link/Coordenadas">
                <button class="btn-gps" onclick="getGPS('coords')" title="GPS">üìç</button>
            </div>
        </div>
    </div>

     <div class="row-fixed">
        <div class="col"><label>Predio</label><input type="text" id="predio" placeholder="Nro. predio"></div>

        <div class="col">

            <label>COORDENADAS CASA</label>
            <div class="gps-group">
                <input type="text" id="coordscas" placeholder="Pegar Link/coordenadas">
                <button class="btn-gps" onclick="getGPS('coordscas')" title="GPS">üìç</button>
            </div>
        </div>
    </div>

    <label style="color:#03dac6; border-bottom:1px solid #333; padding-bottom:5px;">‚¨ÜÔ∏è QUEDAN INSTALADOS</label>
    <div id="container-quedan"></div>
    <button class="btn-add" onclick="addRow('container-quedan', 'Equipo', '')">‚ûï Agregar Nuevo</button>

    <label style="color:#cf6679; border-bottom:1px solid #333; margin-top:25px; padding-bottom:5px;">‚¨áÔ∏è EQUIPOS SALIENTE</label>
    <div id="container-salientes"></div>
    <button class="btn-add" onclick="addRow('container-salientes', 'Equipo', '')">‚ûï Agregar Saliente</button>

    <h3>üì° Detalles T√©cnicos</h3>
    
    <label>Instalaci√≥n (Texto libre)</label>
    <input type="text" id="tipoInst" placeholder="Ej: A√©reo, Ducter√≠a...">

    <h3>üìù Descripci√≥n del Trabajo</h3>
    <label>Antecedente</label>
    <input type="text" id="antecedente" placeholder="Problemas anteriores"> 
    <label>Problema</label>
    <input type="text" id="problema" placeholder="Detallar problema">
    
    <label>Soluci√≥n</label>
    <input type="text" id="solucion" placeholder="Detallar soluci√≥n del problema">
    
    <div class="row-fixed" style="margin-top:15px;">
        <div class="col"><label>Nivel NAP</label><input type="text" id="nNap" value="-"></div>
        <div class="col"><label>Nivel ONT</label><input type="text" id="nOnt" value="-"></div>
    </div>

    <label>Ubicaci√≥n de ONT</label>
    <input type="text" id="ubiont" placeholder="ONT">
    <label>Ubicaci√≥n de Router</label>
    <input type="text" id="ubirou" placeholder="Router">
    
    <div class="row-fixed">
        <div class="col"><label>Disp. Wifi</label><input type="number" id="dWifi" value="3"></div>
        <div class="col"><label>Disp. Cable</label><input type="number" id="dCable" value="0"></div>
    </div>

    <h3>üìè Metrajes</h3>
    <label>FIBRA √ìPTICA</label>
    <div class="row-fixed">
        <div class="col"><input type="number" id="fIni" placeholder="Ini" oninput="calc()"></div>
        <div class="col"><input type="number" id="fFin" placeholder="Fin" oninput="calc()"></div>
        <div class="col"><input type="text" id="fTot" placeholder="Tot" readonly class="total-display"></div>
    </div>
    
    <label>UTP (Opcional)</label>
    <div class="row-fixed">
        <div class="col"><input type="number" id="uIni" placeholder="Ini" oninput="calc()"></div>
        <div class="col"><input type="number" id="uFin" placeholder="Fin" oninput="calc()"></div>
        <div class="col"><input type="text" id="uTot" placeholder="Tot" readonly class="total-display"></div>
    </div>
    <label>RG6 (Opcional)</label>
    <div class="row-fixed">
        <div class="col"><input type="number" id="rIni" placeholder="Ini" oninput="calc()"></div>
        <div class="col"><input type="number" id="rFin" placeholder="Fin" oninput="calc()"></div>
        <div class="col"><input type="text" id="rTot" placeholder="Tot" readonly class="total-display"></div>
    </div>
    <h3>üì∂ Info T√©cnica / Analyzer</h3>
    <p style="margin:0; font-size:10px; color:#aaa; margin-bottom:5px;">*wifi monitor_.</p>
    <div class="row-fixed">
        <div class="col"><label>C√≥d. Inicial</label><input type="text" id="codIni"></div>
        <div class="col"><label>C√≥d. Final</label><input type="text" id="codFin"></div>
    </div>
    <div class="row-fixed">
        <div class="col"><label>Red (SSID)</label><input type="text" id="ssid" value="Xtrim_"></div>
        <div class="col"><label>Pass</label><input type="text" id="pass"></div>
    </div>

    <label>ANALYZER (Niveles)</label>
    <div class="row-fixed">
        <div class="col"><input type="text" id="an1" placeholder="Dorm"></div>
        <div class="col"><input type="text" id="an2" placeholder="Sala"></div>
        <div class="col"><input type="text" id="an3" placeholder="Local"></div>
    </div>

    <h3>üõ†Ô∏è Materiales</h3>
    <div id="container-materiales"></div>
    <button class="btn-add" onclick="addRow('container-materiales', '', '')">‚ûï Material</button>

    <h3>üìù GESTION DE CALIDAD</h3>
     <p style="margin:0; font-size:16px; color:#feffef; margin-bottom:5px;">Respuestas dadas por el cliente en sitio. En una escala del 1 al 10, siendo el 10 la calificaci√≥n m√°s alta.</p>
     <div class="col"><label>1.¬øCon cuanto califica usted la experiencia recibida con el trabajo del grupo t√©cnico?</label>
        <input type="text" id="C1" value="10" ></div>
        <div class="col"><label>2.- ¬øDe acuerdo a esta experiencia, usted recomendar√≠a nuestro servicio y trabajo?</label>
        <input type="text" id="C2" value="10" ></div>
        

    <h3 style="color:#ffcc80; border-color:#ffcc80;">üëÅÔ∏è OBSERVACIONES ADICIONALES</h3>
    <textarea id="obsInput" rows="3" placeholder="Escribe aqu√≠ notas adicionales..."></textarea>
    
    <button onclick="borrarTodo()" style="width:100%; padding:15px; margin-top:30px; background:#ef5350; border:none; color:white; border-radius:8px; font-weight:bold; font-size:14px; text-transform:uppercase;">üóëÔ∏è Borrar Todo y Empezar</button>

    <div class="btn-container">
        <button class="action btn-1" onclick="generar(1)">1. WSP</button>
        <button class="action btn-2" onclick="generar(2)">2. FULL</button>
        <button class="action btn-3" onclick="generar(3)">3. OBS</button>
        <button class="action btn-2" onclick="enviarAGoogleSheets()">üì§ Enviar a Sheets</button>
    </div>

    <script>

        const GOOGLE_SHEETS_URL = "https://script.google.com/macros/s/AKfycbywu_VJk0gTJFYqvvt1Vv8-Pq3WFniYQ0S3biVW6FLTEs7wadFacGF8_2wra1jzfqjm/exec";

        function enviarAGoogleSheets() {

        const datos = {
            tipoNota: document.getElementById("tipoNota").value,
            cto: document.getElementById("cto").value,
            cta: document.getElementById("cta").value,
            cliente: document.getElementById("cliente").value,
            tec: document.getElementById("tec").value,
            nap: document.getElementById("nap").value,
            coordNap: document.getElementById("coords").value,
            coordCasa: document.getElementById("coordscas").value,
            obs: document.getElementById("obsInput").value
        };

        fetch(GOOGLE_SHEETS_URL, {
            method: "POST",
            mode: "no-cors",
            body: JSON.stringify(datos)
        })
        .then(() => {
            alert("‚úÖ Datos enviados correctamente a Google Sheets");
        })
        .catch(() => {
            alert("‚ùå Error al enviar datos");
        });
        }



        // --- L√ìGICA DE AUTO-GUARDADO ---
        document.addEventListener('input', function(e) { saveData(); });

        function saveData() {
            const inputs = document.querySelectorAll('input[id], textarea[id]');
            inputs.forEach(el => localStorage.setItem(el.id, el.value));
            saveDynamicSection('container-quedan');
            saveDynamicSection('container-salientes');
            saveDynamicSection('container-materiales');
            localStorage.setItem('migra_saved', 'true');
            const status = document.getElementById('save-status');
            status.innerText = "Guardado en el tel√©fono...";
            setTimeout(() => status.innerText = "", 2000);
        }

        function saveDynamicSection(containerId) {
            const data = [];
            document.querySelectorAll(`#${containerId} .dynamic-row`).forEach(row => {
                data.push({
                    name: row.querySelector('.name').value,
                    desc: row.querySelector('.desc').value
                });
            });
            localStorage.setItem(containerId, JSON.stringify(data));
        }

        function loadData() {
            if (localStorage.getItem('migra_saved') === 'true') {
                const inputs = document.querySelectorAll('input[id], textarea[id]');
                inputs.forEach(el => {
                    const val = localStorage.getItem(el.id);
                    if (val !== null) el.value = val;
                });
                loadDynamicSection('container-salientes');
                loadDynamicSection('container-quedan');
                loadDynamicSection('container-materiales');
                calc();
            } else {
                loadDefaults();
            }
        }

        function loadDynamicSection(containerId) {
            const json = localStorage.getItem(containerId);
            if (json) {
                const data = JSON.parse(json);
                if(data.length > 0) {
                    data.forEach(item => addRow(containerId, item.name, item.desc));
                }
            }
        }

        function loadDefaults() {
            addRow('container-salientes', 'ONT:', '');
            addRow('container-salientes', 'ROUTER:', '');
            addRow('container-quedan', 'ONT:', '');
            addRow('container-quedan', 'ROUTER:', '');
            addRow('container-quedan', 'ROUTER 2:', '');
            const mats = [['CONECTORES', '2'], ['AMARRAS', '5'], ['TENSORES', '2'], ['GRAPAS', '10'], ['RJ45', '0'], ['TUBILLOS', '0']];
            mats.forEach(m => addRow('container-materiales', m[0], m[1]));
            saveData();
        }

        function borrarTodo() {
            if(confirm("¬øBorrar todos los datos y empezar de cero?")) {
                localStorage.clear();
                location.reload();
            }
        }

        window.onload = function() { loadData(); };

        // --- FUNCIONES DE LA HERRAMIENTA ---
        function getGPS(inputId) {
    if (!navigator.geolocation) {
        alert("GPS no soportado en este navegador.");
        return;
    }

    navigator.geolocation.getCurrentPosition(
        (pos) => {
            let lat = pos.coords.latitude.toFixed(7);
            let lon = pos.coords.longitude.toFixed(7);
            document.getElementById(inputId).value = `${lat}, ${lon}`;
            saveData(); // mantiene el autoguardado
        },
        () => {
            alert("No se pudo obtener la ubicaci√≥n. Activa el GPS.");
        }
    );
}

        function addRow(containerId, phName, phDesc) {
            const div = document.createElement('div');
            div.className = 'dynamic-row';
            div.innerHTML = `
                <input type="text" class="name" placeholder="Tipo" value="${phName}">
                <input type="text" class="desc" placeholder="Detalle" value="${phDesc}">
                <button class="btn-del" onclick="removeRow(this)">X</button>
            `;
            document.getElementById(containerId).appendChild(div);
        }

        function removeRow(btn) {
            btn.parentElement.remove();
            saveData();
        }

        function readDynamic(containerId) {
            let items = [];
            document.querySelectorAll(`#${containerId} .dynamic-row`).forEach(row => {
                let n = row.querySelector('.name').value;
                let v = row.querySelector('.desc').value;
                if(n && v) items.push(`* *${n}:* ${v}`);
                else if(n) items.push(`* *${n}*`);
            });
            return items.join('\n');
        }

        function calc() {
            let f = Math.abs((document.getElementById('fIni').value||0) - (document.getElementById('fFin').value||0));
            document.getElementById('fTot').value = f;

            let u = Math.abs((document.getElementById('uIni').value||0) - (document.getElementById('uFin').value||0));
            document.getElementById('uTot').value = u;

            let r = Math.abs((document.getElementById('rIni').value||0) - (document.getElementById('rFin').value||0));
            document.getElementById('rTot').value = r;
        }

        function copiar(txt) {
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(txt)
                    .then(() => alert("¬°COPIADO AL PORTAPAPELES!"))
                    .catch(err => copiarPlanB(txt));
            } else {
                copiarPlanB(txt);
            }
        }

        function copiarPlanB(txt) {
            const el = document.createElement('textarea');
            el.value = txt;
            document.body.appendChild(el);
            el.select();
            try {
                document.execCommand('copy');
                alert("¬°COPIADO (Modo Compatible)!");
            } catch (err) {
                alert("Error: No se pudo copiar. Intenta seleccionar y copiar manualmente.");
            }
            document.body.removeChild(el);
        }
      
        function generar(tipo) {
            let d = {
                nta: document.getElementById('tipoNota').value,
                ntr: document.getElementById(`numTarea`).value,
                cto: document.getElementById('cto').value,
                cta: document.getElementById('cta').value,
                cli: document.getElementById('cliente').value.toUpperCase(),
                tec: document.getElementById('tec').value.toUpperCase(),
                nap: document.getElementById('nap').value.toUpperCase(),
                coo: document.getElementById('coords').value,
                cdc: document.getElementById('coordscas').value,
                cel: document.getElementById('cel').value,
                pre: document.getElementById('predio').value,
                ins: document.getElementById('tipoInst').value,
                nna: document.getElementById('nNap').value,
                non: document.getElementById('nOnt').value,
                ubio: document.getElementById('ubiont').value,
                ubir: document.getElementById('ubirou').value,
                dwi: document.getElementById('dWifi').value,
                dca: document.getElementById('dCable').value,
                ant: document.getElementById('antecedente').value,
                prob: document.getElementById('problema').value,
                sol: document.getElementById('solucion').value,
                obsManual: document.getElementById('obsInput').value,
                fini: document.getElementById('fIni').value,
                ffin: document.getElementById('fFin').value,
                ftot: document.getElementById('fTot').value,
                uini: document.getElementById('uIni').value,
                ufin: document.getElementById('uFin').value,
                utot: document.getElementById('uTot').value,
                rini: document.getElementById('rIni').value,
                rfin: document.getElementById('rFin').value,
                rtot: document.getElementById('rTot').value,
                cini: document.getElementById('codIni').value,
                cfin: document.getElementById('codFin').value,
                ssid: document.getElementById('ssid').value,
                pass: document.getElementById('pass').value,
                an1: document.getElementById('an1').value,
                an2: document.getElementById('an2').value,
                an3: document.getElementById('an3').value,
                C1: document.getElementById('C1').value,
                C2: document.getElementById('C2').value
            };

            let l_sal = readDynamic('container-salientes');
            let l_nue = readDynamic('container-quedan');
            let l_mat = readDynamic('container-materiales');
            let obs_auto = `Se realiza ${d.nta}.\nLa DROP va por ${d.ins} .`;
            let txt = "";

            if(tipo === 1) { // WSP
                txt = `*Orden:* ${d.nta}\n*CTO:*${d.cto}\n*CTA:* ${d.cta}\n*CLIENTE:* ${d.cli}\n*COORDENADAS CASA:* ${d.cdc}\n*TEC:* ${d.tec}\n*Nap:* ${d.nap}\n*COORDENADAS NAP:* ${d.coo}\n*Equipo saliente:*\n${l_sal}\n*Quedan:*\n${l_nue}`;
            } 
            else if(tipo === 2) { // FULL
                txt = 
                `*ORDEN:* ${d.nta}\n`+
                `*NUMERO TAREA:* ${d.ntr}\n`+
                `*CTO:* ${d.cto}\n`+
                `*CTA:* ${d.cta}\n`+
                `*CLIENTE:* ${d.cli}\n`+
                `*CELULAR:* ${d.cel}\n`+
                `*PREDIO:* ${d.pre}\n`+
                `*COORDENADAS CASA:* ${d.cdc}\n`+
                `*NAP:* ${d.nap}\n`+
                `*COORDENADAS NAP:* ${d.coo}\n`+
                `*NIVELES*\n*NAP:* ${d.nna}\n`+
                `*ONT:* ${d.non}\n\n*DESCRIPCION*\n`+
                `*ANTECEDENTES:* ${d.ant}\n`+
                `*PROBLEMA:* ${d.prob}\n`+
                `*SOLUCION:* ${d.sol}\n\n`+
                `*OBSERVACIONES:* ${obs_auto}\n`+
                `${d.obsManual}\n\n`+
                `*MEDIDAS DE CABLEADO*\n`+
                `*FIBRA*\n`+
                `* *PUNTA INICIAL:* ${d.fini}\n`+
                `* *PUNTA FINAL:* ${d.ffin}\n`+
                `* *TOTAL:* ${d.ftot}\n`+
                `*UTP*\n`+
                `* *PUNTA INICIAL:* ${d.uini}\n`+
                `* *PUNTA FINAL:* ${d.ufin}\n`+
                `* *TOTAL:* ${d.utot}\n`+
                `*RG6*\n`+
                `* *PUNTA INICIAL:* ${d.rini}\n`+
                `* *PUNTA FINAL:* ${d.rfin}\n`+
                `* *TOTAL:* ${d.rtot}\n\n`+
                `*INFORMACION TECNICA*\n`+
                ` *wifi monitor*.\n`+
                `* *CODIGO INICIAL:* ${d.cini}\n`+
                `* *CODIGO FINAL:* ${d.cfin}\n`+
                `* *NOMBRE DE RED:* ${d.ssid}\n`+
                `* *CONTRASE√ëA:* ${d.pass}\n\n`+
                `*NIVELES ANALYZER*\n`+
                `* *DORMITORIO:* ${d.an1}\n`+
                `* *SALA:* ${d.an2}\n`+
                `* *Local:* ${d.an3}\n\n`+
                `*EQUIPOS QUEDAN*\n${l_nue}\n\n`+
                `*DISPOSITIVOS CONECTADOS*\n`+
                `* *Wifi:* ${d.dwi}\n`+
                `* *CABLE:* ${d.dca}\n\n`+
                `*UBICACION DE EQUIPOS TERMINALES*\n`+
                `* *ONT:* ${d.ubio}\n`+
                `* *Router:* ${d.ubir}\n\n`+
                `*EQUIPOS RETIRADOS*\n${l_sal}\n\n`+
                `*MATERIALES*\n`+
                `* *FO DROP:* ${d.ftot}\n`+
                `* *CABLE UTP:* ${d.utot}\n`+
                `* *CABLE RG6:* ${d.rtot}\n${l_mat}\n\n`+
                `*GESTI√ìN DE CALIDAD*\n`+
                `* *¬øCon cuanto califica usted la experiencia recibida con el trabajo del grupo t√©cnico?* ${d.C1}\n`+
                `* *¬øDe acuerdo a esta experiencia, usted recomendar√≠a nuestro servicio y trabajo?* ${d.C2}\n`;
            } 
            else if(tipo === 3) { // OBS
                txt = 
                      `CTO:${d.cto}\n`+
                      `CTA: ${d.cta}\n`+
                      `CLIENTE: ${d.cli}\n\n`+
                      `NAP: ${d.nap}\n` +
                      `Niveles\n`+
                      `NAP (Nivel de Nap): ${d.nna}\n` +
                      `ONT (Nivel ONT): ${d.non}\n\n` +
                      `COORDENADAS\n` +
                      `COORDENADAS CASA: ${d.cdc}\n`+
                      `COORDENADAS NAP: ${d.coo}\n\n`+
                      `DESCRIPCION\n` +
                      `-Antecedentes: ${d.ant}\n` +
                      `-Problema: ${d.prob}\n` +
                      `-Solucion: ${d.sol}\n\n` +
                      `OBSERVACIONES\n` +
                      `${d.obsManual}`;
            }
            copiar(txt);
        }
    </script>
</body>
</html>